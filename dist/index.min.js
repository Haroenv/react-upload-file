!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):"object"==typeof exports?exports["react-fileupload"]=t(require("react")):e["react-fileupload"]=t(e.React)}(this,function(e){return function(e){function t(a){if(o[a])return o[a].exports;var r=o[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){e.exports=o(1)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),u=o(2),d=a(u),f=function(){},c=0,h=[!0],m=[],y=0,b=function(e){function t(e){r(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));o.commonChooseFile=function(e){var t=o.beforeChoose();t!==!0&&void 0!==t||e.target.click()},o.commonChange=function(e){var t=void 0;e.dataTransfer?t=e.dataTransfer.files:e.target?t=e.target.files:"";var a="function"==typeof o.numberLimit?o.numberLimit():o.numberLimit;if(o.multiple&&a&&t.length>a){for(var r={},n=0;n<a;n++)r[n]=t[n];r.length=a,t=r}o.files=t,o.chooseFile(t,o.parent),o.chooseAndUpload&&o.commonUpload(e)},o.commonUpload=function(e){var t=o.files.length&&o.files[0].mill||(new Date).getTime(),a=o.beforeUpload(o.files,o.parent,t);if(a!==!0&&void 0!==a&&"object"!==("undefined"==typeof a?"undefined":p(a)))return void(e.target.value="");if(o.files){if(!o.baseUrl)throw new Error("baseUrl missing in options");var r={},n=new FormData;o.textBeforeFiles&&(n=o.appendFieldsToFormData(n)),o.withoutFileUpload||!function(){var e=p(o.fileFieldName);Object.keys(o.files).forEach(function(t){if("length"!==t)if("function"===e){var a=o.files[t],r=o.fileFieldName(a);n.append(r,a)}else if("string"===e){var i=o.files[t];n.append(o.fileFieldName,i)}else{var s=o.files[t];n.append(s.name,s)}})}(),o.textBeforeFiles||(n=o.appendFieldsToFormData(n));var i=o.baseUrl,s="function"==typeof o.param?o.param(o.files):o.param,l="";s&&!function(){var e=[];s._=t,Object.keys(s).forEach(function(t){return e.push(t+"="+s[t])}),l="?"+e.join("&")}();var u=i+l,d=new XMLHttpRequest;d.open("POST",u,!0),d.withCredentials=o.withCredentials;var f=o.requestHeaders;f&&Object.keys(f).forEach(function(e){return d.setRequestHeader(e,f[e])}),o.timeout&&(d.timeout=o.timeout,d.ontimeout=function(){o.uploadError({type:"TIMEOUTERROR",message:"timeout"},o.parent),r.isTimeout=!1},r.isTimeout=!1,setTimeout(function(){r.isTimeout=!0},o.timeout)),d.onreadystatechange=function(){try{if(4===d.readyState&&d.status>=200&&d.status<400){var e="json"===o.dataType?JSON.parse(d.responseText):d.responseText;o.uploadSuccess(e,o.parent)}else if(4===d.readyState){var t="json"===o.dataType?JSON.parse(d.responseText):d.responseText;o.uploadFail(t,o.parent)}}catch(a){!r.isTimeout&&o.uploadError({type:"FINISHERROR",message:a.message},o.parent)}},d.onerror=function(){try{var e="json"===o.dataType?JSON.parse(d.responseText):d.responseText;o.uploadError({type:"XHRERROR",message:e},o.parent)}catch(t){o.uploadError({type:"XHRERROR",message:t.message},o.parent)}},d.onprogress=d.upload.onprogress=function(e){o.uploading(e,o.parent,t)},o.withoutFileUpload?d.send(null):d.send(n),m.push(d);var c=m.length-1;y=c,d.onabort=function(){return o.onabort(o.parent,t,c)},o.doUpload(o.files,o.parent,t,y),e.target.value=""}},o.state={chooseBtn:{},uploadBtn:{},before:[],middle:[],after:[]},o.userAgent=o.getUserAgent(),o.isIE=!(o.checkIE()<0||o.checkIE()>=10);var a=e.options&&e.options.tag;return o.IETag=a?a+"-":"",o.updateProps(e),o}return i(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){this.updateProps(e)}},{key:"getUserAgent",value:function(){var e=this.props.options&&this.props.options.userAgent,t="undefined"!=typeof navigator;if(!t&&!e)throw new Error("`options.userAgent` must be set rendering react-fileuploader in situations when `navigator` is not defined in the global namespace. (on the server, for example)");return t?navigator.userAgent:e}},{key:"updateProps",value:function(e){var t=this,o=e.options;Object.keys(o).forEach(function(e){switch(e){case"multiple":case"numberLimit":case"fileFieldName":case"withCredentials":case"requestHeaders":case"disabledIEChoose":case"withoutFileUpload":case"textBeforeFiles":case"chooseAndUpload":o[e]=o[e]||!1;break;case"accept":case"paramAddToField":o[e]=o[e]||null;break;case"wrapperDisplay":o[e]=o[e]||"inline-block";break;case"timeout":o[e]="number"==typeof o[e]&&o[e]>0?o[e]:0;break;case"beforeChoose":case"chooseFile":case"beforeUpload":case"doUpload":case"uploading":case"uploadSuccess":case"uploadError":case"uploadFail":case"onabort":o[e]=o[e]||f;break;case"filesToUpload":o[e]=o[e]||[];break;case"files":o[e]=o[e]||t[e]||!1;break;case"dataType":o[e]&&"text"===o[e].toLowerCase()?o[e]="text":o[e]="json"}});var a=s({},o,{isIe:!(o.checkIE()<0||o.checkIE()>=10),parent:a.parent});o.filesToUpload.length&&!o.isIE&&o.filesToUpload.forEach(function(e){o.files=[e],o.commonUpload()});var r=void 0,n=void 0,i=0,p=[],l=[],u=[];this.chooseAndUpload?d.default.Children.forEach(e.children,function(e){e&&"chooseAndUpload"===e.ref?(r=e,i++):0===i?p.push(e):1===i?l.push(e):""}):d.default.Children.forEach(e.children,function(e){e&&"chooseBtn"===e.ref?(r=e,i++):e&&"uploadBtn"===e.ref?(n=e,i++):0===i?p.push(e):1===i?l.push(e):u.push(e)}),this.setState({chooseBtn:r,uploadBtn:n,before:p,middle:l,after:u})}},{key:"appendFieldsToFormData",value:function(e){var t="function"==typeof this.paramAddToField?this.paramAddToField():this.paramAddToField;return t&&Object.keys(t).map(function(o){return e.append(o,t[o])}),e}},{key:"ieBeforeChoose",value:function(e){var t=this.beforeChoose();t!==!0&&void 0!==t&&e.preventDefault()}},{key:"ieChooseFile",value:function(e){this.fileName=e.target.value.substring(e.target.value.lastIndexOf("\\")+1),this.chooseFile(this.fileName,this.parent),this.chooseAndUpload&&this.ieUpload()!==!1&&document.getElementById("ajax-upload-file-form-"+this.IETag+c).submit(),e.target.blur()}},{key:"ieUpload",value:function(e){var t=this,o=(new Date).getTime(),a=this.beforeUpload(this.fileName,this.parent,o);if(!this.fileName||a!==!0&&void 0!==a)return e&&e.preventDefault(),!1;var r=this.baseUrl,n="function"==typeof this.param?this.param(this.fileName):this.param,i="";n&&!function(){var e=[];n._=o,void 0===n.ie&&(n.ie="true"),Object.keys(n).forEach(function(t){void 0!==n[t]&&e.push(t+"="+n[t])}),i="?"+e.join("&")}();var s=r+i;document.getElementById("ajax-upload-file-form-"+this.IETag+c).setpropibute("action",s);var p=this.fakeProgress(),l=0,u=0,d=setInterval(function(){l=p(l),t.uploading({loaded:l,total:100},t.parent,o),++u>=150&&clearInterval(d)},200),f=c;window.attachEvent?document.getElementById("ajax-upload-file-frame-"+this.IETag+f).attachEvent("onload",m):document.getElementById("ajax-upload-file-frame-"+this.IETag+f).addEventListener("load",m);var m=function(){clearInterval(d);try{t.uploadSuccess(t.ieCallback(t.dataType,f),t.parent)}catch(e){t.uploadError(e,t.parent)}finally{var o=document.getElementById("ajax-upload-hidden-input-"+t.IETag+f);o.outerHTML=o.outerHTML}};this.doUpload(this.fileName,this.parent,o),h[c]=!1}},{key:"IECallback",value:function(e,t){h[t]=!0;var o=document.getElementById("ajax-upload-file-frame-"+this.IETag+t),a={},r=o.contentWindow?o.contentWindow.document.body:o.contentDocument.document.body;if(!r)throw new Error("Your browser does not support async upload");try{a.responseText=r.innerHTML||"null innerHTML",a.json=JSON?JSON.parse(a.responseText):""+a.responseText}catch(n){if(n.message&&n.message.indexOf("Unexpected token")>=0){if(a.responseText.indexOf("{")>=0){var i=a.responseText.substring(a.responseText.indexOf("{"),a.responseText.lastIndexOf("}")+1);return JSON?JSON.parse(i):""+i}return{type:"FINISHERROR",message:n.message}}throw n}return"json"===e?a.json:a.responseText}},{key:"forwardChoose",value:function(){return!this.isIE&&void this.commonChooseFile()}},{key:"fowardRemoveFile",value:function(e){this.files=e(this.files)}},{key:"filesToUpload",value:function(e){this.isIE||(this.files=e,this.commonUpload())}},{key:"abort",value:function(e){void 0===e?m[y].abort():m[e].abort()}},{key:"checkIE",value:function(){var e=this.userAgent,t=e.indexOf("MSIE");return t<0?-1:parseFloat(e.substring(t+5,e.indexOf(";",t)))}},{key:"fakeProgress",value:function(){var e=6,t=.3,o=98,a=.2;return function(r){var n=r;return n>=o?n:(n+=e,e-=t,e<a&&(e=a),n)}}},{key:"multiIEForm",value:function(){for(var e=this,t=[],o=!1,a=function(a){if(!h[a]||!o){var n=h[a],i={position:"absolute",left:"-30px",top:0,zIndex:"50",fontSize:"80px",width:"200px",opacity:0,filter:"alpha(opacity=0)"},p={accept:e.accept,disabled:r},l=d.default.createElement("input",s({type:"file",name:"ajax-upload-hidden-input-"+a,id:"ajax-upload-hidden-input-"+a,ref:"ajax-upload-hidden-input-"+a,onChange:e.ieChooseFile,onClick:e.ieBeforeChoose,style:i},p));a=""+e.IETag+a,t.push(d.default.createElement("form",{id:"ajax-upload-file-form-"+a,method:"post",target:"ajax-upload-file-frame-"+a,key:"ajax-upload-file-form-"+a,encType:"multipart/form-data",ref:"form-"+a,onSubmit:e.ieUpload,style:{display:n?"block":"none"}},e.state.before,d.default.createElement("div",{style:{overflow:"hidden",position:"relative",display:"inline-block"}},e.state.chooseBtn,l),e.state.middle,d.default.createElement("div",{style:{overflow:"hidden",position:"relative",display:e.chooseAndUpload?"none":e.wrapperDisplay}},e.state.uploadBtn,d.default.createElement("input",{type:"submit",style:{position:"absolute",left:0,top:0,fontSize:"50px",width:"200px",opacity:0}})),e.state.after)),t.push(d.default.createElement("iframe",{id:"ajax-upload-file-frame-"+a,name:"ajax-upload-file-frame-"+a,key:"ajax-upload-file-frame-"+a,className:"ajax-upload-file-frame",style:{display:"none",width:0,height:0,margin:0,border:0}}))}},r="function"==typeof this.disabledIEChoose?this.disabledIEChoose():this.disabledIEChoose,n=0;n<h.length;n++)a(n),h[n]&&!o&&(o=!0,c=n),n!==h.length-1||o||h.push(!0);return d.default.createElement("div",{className:this.props.className,style:this.props.style,id:"react-file-uploader"},t)}},{key:"render",value:function(){if(this.isIE)return this.multiIEForm();var e={accept:this.accept,multiple:this.multiple};return d.default.createElement("div",{className:this.props.className,style:this.props.style},this.state.before,d.default.createElement("div",{onClick:this.commonChooseFile,style:{overflow:"hidden",postion:"relative",display:this.wrapperDisplay}},this.state.chooseBtn),this.state.middle,d.default.createElement("div",{onClick:this.commonUpload,style:{overflow:"hidden",postion:"relative",display:this.chooseAndUpload?"none":this.wrapperDisplay}},this.state.uploadBtn),this.state.after,d.default.createElement("input",s({type:"file",name:"ajax-upload-file-input",style:{display:"none"},onChange:this.commonChange},e)))}}]),t}(u.Component);b.propTypes={options:u.PropTypes.shape({baseUrl:u.PropTypes.string.isRequired,param:u.PropTypes.oneOfType([u.PropTypes.object,u.PropTypes.func]),dataType:u.PropTypes.string,chooseAndUpload:u.PropTypes.bool,paramAddToField:u.PropTypes.oneOfType([u.PropTypes.object,u.PropTypes.func]),wrapperDisplay:u.PropTypes.string,timeout:u.PropTypes.number,accept:u.PropTypes.string,multiple:u.PropTypes.bool,numberLimit:u.PropTypes.oneOfType([u.PropTypes.number,u.PropTypes.func]),fileFieldName:u.PropTypes.oneOfType([u.PropTypes.string,u.PropTypes.func]),withCredentials:u.PropTypes.bool,requestHeaders:u.PropTypes.object,tag:u.PropTypes.string,userAgent:u.PropTypes.string,disabledIEChoose:u.PropTypes.oneOfType([u.PropTypes.bool,u.PropTypes.func]),withoutFileUpload:u.PropTypes.bool,filesToUpload:u.PropTypes.arrayOf(u.PropTypes.object),textBeforeFiles:u.PropTypes.bool,beforeChoose:u.PropTypes.func,chooseFile:u.PropTypes.func,beforeUpload:u.PropTypes.func,doUpload:u.PropTypes.func,uploading:u.PropTypes.func,uploadSuccess:u.PropTypes.func,uploadError:u.PropTypes.func,uploadFail:u.PropTypes.func,onabort:u.PropTypes.func}).isRequired,parent:u.PropTypes.object,style:u.PropTypes.object,className:u.PropTypes.string},t.default=b},function(t,o){t.exports=e}])});